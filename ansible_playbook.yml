---
- name: Gather Disk Information
  hosts: all
  connection: local 
  gather_facts: yes

  tasks:

    - name: Display Disk Information
      shell: df -h /dev/root | awk 'NR==2 {print "Disk Size:" $2  "\n" "Used Storage:" $4}'
      register: disk_info

    - name: Show Disk Size and Available Space
      debug: 
        msg: "{{ disk_info.stdout }}"

    - name: Display memory information
      shell: free -h | awk 'NR==2 {print "Total Memory:" $2 "\n" "Available Memory:" $7}'
      register: mem

    - name: Show Memory Information
      debug:
        msg:  |
          Host: {{ inventory_hostname }}
          {{ mem.stdout }}

          ---
- name: Check server uptime
  hosts: all                                                       # Replace with your inventory group or host
  gather_facts: yes                                                # No need to gather extensive facts for this simple check

  tasks:
    - name: Execute uptime command
      ansible.builtin.command: uptime -p
      register: uptime_output
      changed_when: true

    - name: Display uptime
      ansible.builtin.debug:
        var: uptime_output.stdout

    - name: Debug disk information
      debug:
        var: ansible_facts.devices # Shows details about all disks
      when: ansible_facts.devices is defined

    - name: Debug mounted filesystem information
      debug:
        var: ansible_facts.mounts # Shows details about mounted filesystems
      when: ansible_facts.mounts is defined